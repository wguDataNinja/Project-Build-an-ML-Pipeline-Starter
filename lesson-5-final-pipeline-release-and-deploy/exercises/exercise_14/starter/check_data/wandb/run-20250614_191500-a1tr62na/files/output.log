[1m=================================================================================================== test session starts ====================================================================================================[0m
platform linux -- Python 3.10.13, pytest-8.3.2, pluggy-1.5.0 -- /opt/venv/bin/python
cachedir: .pytest_cache
rootdir: /workspace/nd0821-c2-build-model-workflow-exercises/lesson-5-final-pipeline-release-and-deploy/exercises/exercise_14/starter/check_data
plugins: anyio-4.6.2.post1, hydra-core-1.3.2
collected 4 items                                                                                                                                                                                                          [0m[1m

test_data.py::test_column_presence_and_type [31mFAILED[0m
test_data.py::test_class_names [32mPASSED[0m
test_data.py::test_column_ranges [32mPASSED[0m
test_data.py::test_kolmogorov_smirnov [32mPASSED[0m

========================================================================================================= FAILURES =========================================================================================================
[31m[1m______________________________________________________________________________________________ test_column_presence_and_type _______________________________________________________________________________________________[0m

data =        danceability  energy   key  loudness  mode  speechiness  acousticness  instrumentalness  liveness  valence    t...00    0.3180   0.2600  143.018  audio_features       443077               4        psytrance

[42896 rows x 15 columns]

    [0m[94mdef[39;49;00m[90m [39;49;00m[92mtest_column_presence_and_type[39;49;00m(data):[90m[39;49;00m
    [90m[39;49;00m
        [90m# Disregard the reference dataset[39;49;00m[90m[39;49;00m
        _, data = data[90m[39;49;00m
    [90m[39;49;00m
        required_columns = {[90m[39;49;00m
            [33m"[39;49;00m[33mtime_signature[39;49;00m[33m"[39;49;00m: pd.api.types.is_integer_dtype,[90m[39;49;00m
            [33m"[39;49;00m[33mkey[39;49;00m[33m"[39;49;00m: pd.api.types.is_integer_dtype,[90m[39;49;00m
            [33m"[39;49;00m[33mdanceability[39;49;00m[33m"[39;49;00m: pd.api.types.is_float_dtype,[90m[39;49;00m
            [33m"[39;49;00m[33menergy[39;49;00m[33m"[39;49;00m: pd.api.types.is_float_dtype,[90m[39;49;00m
            [33m"[39;49;00m[33mloudness[39;49;00m[33m"[39;49;00m: pd.api.types.is_float_dtype,[90m[39;49;00m
            [33m"[39;49;00m[33mspeechiness[39;49;00m[33m"[39;49;00m: pd.api.types.is_float_dtype,[90m[39;49;00m
            [33m"[39;49;00m[33macousticness[39;49;00m[33m"[39;49;00m: pd.api.types.is_float_dtype,[90m[39;49;00m
            [33m"[39;49;00m[33minstrumentalness[39;49;00m[33m"[39;49;00m: pd.api.types.is_float_dtype,[90m[39;49;00m
            [33m"[39;49;00m[33mliveness[39;49;00m[33m"[39;49;00m: pd.api.types.is_float_dtype,[90m[39;49;00m
            [33m"[39;49;00m[33mvalence[39;49;00m[33m"[39;49;00m: pd.api.types.is_float_dtype,[90m[39;49;00m
            [33m"[39;49;00m[33mtempo[39;49;00m[33m"[39;49;00m: pd.api.types.is_float_dtype,[90m[39;49;00m
            [33m"[39;49;00m[33mduration_ms[39;49;00m[33m"[39;49;00m: pd.api.types.is_integer_dtype,  [90m# This is integer, not float as one might expect[39;49;00m[90m[39;49;00m
            [33m"[39;49;00m[33mgenre[39;49;00m[33m"[39;49;00m: pd.api.types.is_string_dtype[90m[39;49;00m
        }[90m[39;49;00m
    [90m[39;49;00m
        [90m# Check column presence[39;49;00m[90m[39;49;00m
        [94massert[39;49;00m [96mset[39;49;00m(data.columns.values).issuperset([96mset[39;49;00m(required_columns.keys()))[90m[39;49;00m
    [90m[39;49;00m
        [94mfor[39;49;00m col_name, format_verification_funct [95min[39;49;00m required_columns.items():[90m[39;49;00m
>           [94massert[39;49;00m format_verification_funct(data[col_name]), [33mf[39;49;00m[33m"[39;49;00m[33mColumn [39;49;00m[33m{[39;49;00mcol_name[33m}[39;49;00m[33m failed test [39;49;00m[33m{[39;49;00mformat_verification_funct[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
[1m[31mE           AssertionError: Column key failed test <function is_integer_dtype at 0x7b9d724ae440>[0m
[1m[31mE           assert False[0m
[1m[31mE            +  where False = <function is_integer_dtype at 0x7b9d724ae440>(0         2.0\n1         8.0\n2         5.0\n3         0.0\n4         2.0\n         ... \n42891     9.0\n42892    11.0\n42893     0.0\n42894     1.0\n42895     0.0\nName: key, Length: 42896, dtype: float64)[0m

[1m[31mtest_data.py[0m:30: AssertionError
[33m===================================================================================================== warnings summary =====================================================================================================[0m
../../../../../../../opt/venv/lib/python3.10/site-packages/wandb/analytics/sentry.py:258
../../../../../../../opt/venv/lib/python3.10/site-packages/wandb/analytics/sentry.py:258
  /opt/venv/lib/python3.10/site-packages/wandb/analytics/sentry.py:258: DeprecationWarning: The `Scope.user` setter is deprecated in favor of `Scope.set_user()`.
    self.scope.user = {"email": email}

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
[36m[1m================================================================================================= short test summary info ==================================================================================================[0m
[31mFAILED[0m test_data.py::[1mtest_column_presence_and_type[0m - AssertionError: Column key failed test <function is_integer_dtype at 0x7b9d724ae440>
assert False
 +  where False = <function is_integer_dtype at 0x7b9d724ae440>(0         2.0\n1         8.0\n2         5.0\n3         0.0\n4         2.0\n         ... \n42891     9.0\n42892    11.0\n42893     0.0\n42894     1.0\n42895     0.0\nName: key, Length: 42896, dtype: float64)
[31m========================================================================================= [31m[1m1 failed[0m, [32m3 passed[0m, [33m2 warnings[0m[31m in 4.79s[0m[31m ==========================================================================================[0m
